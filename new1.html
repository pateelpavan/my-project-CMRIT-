<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CMRIT NSS UNIT</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #8B0000, #000080, #FFFFFF);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            color: #000080;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .container {
            width: 100%;
            max-width: 900px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            margin: 20px 0;
            transition: all 0.3s ease;
        }

        h1 {
            text-align: center;
            font-size: 2.8rem;
            margin-bottom: 20px;
            color: #8B0000;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        h2 {
            color: #000080;
            margin-bottom: 20px;
            text-align: center;
        }

        h3 {
            color: #8B0000;
            margin: 15px 0;
            text-align: center;
        }

        h4 {
            color: #000080;
            margin: 10px 0;
        }

        .page {
            display: none;
        }

        .active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .input-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #8B0000;
        }

        input, textarea, select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #000080;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.9);
            color: #000080;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #8B0000;
            box-shadow: 0 0 10px rgba(139, 0, 0, 0.5);
        }

        input::placeholder, textarea::placeholder {
            color: rgba(0, 0, 128, 0.6);
        }

        button {
            background: linear-gradient(to right, #8B0000, #000080);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s ease;
            display: block;
            margin: 20px auto;
            width: 200px;
        }

        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        .password-hint {
            text-align: center;
            font-size: 0.9rem;
            margin-top: 10px;
            color: #8B0000;
        }

        .photo-preview {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            object-fit: cover;
            border: 5px solid #000080;
            margin: 15px auto;
            display: block;
            background: rgba(255, 255, 255, 0.9);
        }

        .events-gallery {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 20px;
            justify-content: center;
        }

        .event-photo {
            width: 120px;
            height: 120px;
            border-radius: 10px;
            object-fit: cover;
            border: 2px solid #000080;
            transition: transform 0.3s ease;
        }

        .event-photo:hover {
            transform: scale(1.1);
        }

        .portfolio-container {
            text-align: center;
        }

        .portfolio-photo {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            object-fit: cover;
            border: 5px solid #000080;
            margin: 0 auto 20px;
            display: block;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .portfolio-details {
            background: rgba(0, 0, 128, 0.1);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .portfolio-details p {
            margin: 10px 0;
            font-size: 18px;
            text-align: left;
            padding-left: 20px;
        }

        .portfolio-details strong {
            color: #8B0000;
        }

        #qrcode {
            margin: 20px auto;
            padding: 10px;
            background: white;
            border-radius: 10px;
            display: inline-block;
        }

        .footer {
            text-align: center;
            margin-top: 30px;
            padding: 20px;
            font-weight: bold;
            font-size: 1.5rem;
            color: #FFFFFF;
            animation: glow 2s ease-in-out infinite alternate;
            width: 100%;
            background: rgba(139, 0, 0, 0.8);
            border-radius: 10px;
        }

        @keyframes glow {
            from { text-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 15px #8B0000, 0 0 20px #8B0000; }
            to { text-shadow: 0 0 10px #fff, 0 0 20px #fff, 0 0 30px #8B0000, 0 0 40px #8B0000; }
        }

        .file-input-label {
            display: block;
            padding: 10px 15px;
            background: rgba(0, 0, 128, 0.1);
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 15px;
            border: 2px dashed #000080;
            color: #000080;
        }

        .file-input-label:hover {
            background: rgba(0, 0, 128, 0.2);
        }

        input[type="file"] {
            display: none;
        }

        .events-container {
            margin-top: 20px;
        }

        .event-item {
            background: rgba(0, 0, 128, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
        }

        .event-title {
            font-weight: bold;
            color: #8B0000;
            margin-top: 10px;
            display: block;
        }

        .user-list {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
        }

        .user-card {
            background: rgba(0, 0, 128, 0.1);
            border-radius: 10px;
            padding: 15px;
            width: 200px;
            text-align: center;
            transition: transform 0.3s ease;
            border: 2px solid #000080;
        }

        .user-card:hover {
            transform: translateY(-5px);
            background: rgba(0, 0, 128, 0.2);
        }

        .user-card img {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid #000080;
            margin-bottom: 10px;
        }

        .back-button {
            background: linear-gradient(to right, #8B0000, #000080);
            margin-top: 10px;
        }

        .instructions {
            background: rgba(0, 0, 128, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            font-size: 0.9rem;
            border: 2px dashed #8B0000;
        }

        .instructions i {
            color: #8B0000;
            margin-right: 5px;
        }

        .logo-container {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .logo {
            text-align: center;
        }

        .logo i {
            font-size: 3rem;
            color: #8B0000;
            text-shadow: 0 0 10px rgba(139, 0, 0, 0.5);
        }

        .event-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 15px;
        }

        .event-controls button {
            margin: 0;
            width: auto;
            padding: 8px 15px;
            font-size: 14px;
        }

        .event-section {
            background: rgba(0, 0, 128, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 2px solid #000080;
        }

        .download-btn {
            background: linear-gradient(to right, #8B0000, #000080);
        }

        .update-btn {
            background: linear-gradient(to right, #000080, #8B0000);
        }

        .admin-panel {
            background: rgba(0, 0, 128, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            border: 2px solid #8B0000;
        }

        .admin-event {
            background: rgba(139, 0, 0, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            border-left: 5px solid #8B0000;
        }

        .password-strength {
            height: 5px;
            border-radius: 5px;
            margin-top: 5px;
            transition: all 0.3s ease;
        }

        .weak {
            background: #8B0000;
            width: 33%;
        }

        .medium {
            background: #000080;
            width: 66%;
        }

        .strong {
            background: #4caf50;
            width: 100%;
        }

        .event-card {
            background: rgba(0, 0, 128, 0.1);
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            transition: transform 0.3s ease;
            border: 2px solid #000080;
        }

        .event-card:hover {
            transform: translateY(-5px);
            background: rgba(0, 0, 128, 0.2);
        }

        .application-list {
            margin: 20px 0;
        }

        .application-item {
            background: rgba(0, 0, 128, 0.1);
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 2px solid #000080;
        }

        .application-actions {
            display: flex;
            gap: 10px;
        }

        .btn-approve {
            background: linear-gradient(to right, #8B0000, #000080);
            padding: 8px 15px;
            border-radius: 5px;
            border: none;
            color: white;
            cursor: pointer;
        }

        .btn-reject {
            background: linear-gradient(to right, #000080, #8B0000);
            padding: 8px 15px;
            border-radius: 5px;
            border: none;
            color: white;
            cursor: pointer;
        }

        .status-badge {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .status-pending {
            background: #ff9800;
            color: #000;
        }

        .status-approved {
            background: #4caf50;
            color: white;
        }

        .status-rejected {
            background: #f44336;
            color: white;
        }

        .tab-container {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            justify-content: center;
        }

        .tab {
            padding: 10px 20px;
            border-radius: 5px;
            background: rgba(0, 0, 128, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid #000080;
        }

        .tab.active {
            background: rgba(139, 0, 0, 0.2);
            font-weight: bold;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            max-width: 90%;
            max-height: 90%;
            overflow: auto;
            position: relative;
            border: 5px solid #8B0000;
        }

        .close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.5rem;
            color: #8B0000;
            cursor: pointer;
        }

        .qr-info {
            background: rgba(0, 0, 128, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            text-align: center;
            border: 2px dashed #000080;
        }

        .qr-info i {
            color: #8B0000;
            margin-right: 5px;
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .logo-container {
                gap: 15px;
            }
            
            .application-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .application-actions {
                width: 100%;
                justify-content: space-between;
            }
            
            .tab-container {
                flex-wrap: wrap;
            }
            
            .modal-content {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="logo-container">
        <div class="logo">
            <i class="fas fa-hands-helping"></i>
            <p>NSS Unit</p>
        </div>
        <div class="logo">
            <i class="fas fa-university" style="font-size: 3rem;"></i>
            <p>CMRIT</p>
        </div>
    </div>
    
    <div class="container">
        <h1>CMRIT NSS UNIT PORTAL</h1>
        
        <!-- Page 1: Student/Admin Selection -->
        <div id="page1" class="page active">
            <h2>Welcome to NSS Portal</h2>
            <div style="display: flex; justify-content: center; gap: 20px; margin: 30px 0; flex-wrap: wrap;">
                <button onclick="goToPage('pageStudentLogin')" style="background: linear-gradient(to right, #8B0000, #000080);">
                    <i class="fas fa-user-graduate"></i> Student Login
                </button>
                <button onclick="goToPage('pageAdminLogin')" style="background: linear-gradient(to right, #000080, #8B0000);">
                    <i class="fas fa-crown"></i> Admin Login
                </button>
            </div>
            
            <div class="instructions">
                <p><i class="fas fa-info-circle"></i> Students: Login to view and apply for events</p>
                <p><i class="fas fa-info-circle"></i> Admins: Login to manage events and student portfolios</p>
            </div>
        </div>
        
        <!-- Page 2: Student Login -->
        <div id="pageStudentLogin" class="page">
            <h2>Student Login</h2>
            
            <div class="input-group">
                <label for="studentRollNumber">Roll Number</label>
                <input type="text" id="studentRollNumber" placeholder="Enter your roll number">
            </div>
            
            <div class="input-group">
                <label for="studentPassword">Password</label>
                <input type="password" id="studentPassword" placeholder="Enter your password">
            </div>
            
            <button onclick="loginStudent()"><i class="fas fa-sign-in-alt"></i> Login</button>
            <p style="text-align: center; margin-top: 15px;">
                Don't have an account? <a href="#" onclick="goToPage('pageStudentRegister')" style="color: #8B0000;">Register here</a>
            </p>
            <button class="back-button" onclick="goToPage('page1')"><i class="fas fa-arrow-left"></i> Back</button>
        </div>
        
        <!-- Page 3: Student Registration -->
        <div id="pageStudentRegister" class="page">
            <h2>Student Registration</h2>
            
            <div class="input-group">
                <label for="regRollNumber">Roll Number (10 digits)</label>
                <input type="text" id="regRollNumber" placeholder="Enter your 10-digit roll number" maxlength="10">
            </div>
            
            <div class="input-group">
                <label for="regFullName">Full Name</label>
                <input type="text" id="regFullName" placeholder="Enter your full name">
            </div>
            
            <div class="input-group">
                <label for="regBranch">Branch</label>
                <select id="regBranch">
                    <option value="">Select your branch</option>
                    <option value="CSE">Computer Science & Engineering</option>
                    <option value="ECE">Electronics & Communication Engineering</option>
                    <option value="EEE">Electrical & Electronics Engineering</option>
                    <option value="ME">Mechanical Engineering</option>
                    <option value="CE">Civil Engineering</option>
                    <option value="Other">Other</option>
                </select>
            </div>
            
            <div class="input-group">
                <label for="regPassword">Password (min 8 characters with special symbol)</label>
                <input type="password" id="regPassword" placeholder="Create a password">
                <div id="passwordStrength" class="password-strength"></div>
                <small>Password must contain at least 8 characters including one special symbol</small>
            </div>
            
            <div class="input-group">
                <label for="regConfirmPassword">Confirm Password</label>
                <input type="password" id="regConfirmPassword" placeholder="Confirm your password">
            </div>
            
            <button onclick="registerStudent()"><i class="fas fa-user-plus"></i> Register</button>
            <p style="text-align: center; margin-top: 15px;">
                Already have an account? <a href="#" onclick="goToPage('pageStudentLogin')" style="color: #8B0000;">Login here</a>
            </p>
            <button class="back-button" onclick="goToPage('page1')"><i class="fas fa-arrow-left"></i> Back</button>
        </div>
        
        <!-- Page 4: Student Events -->
        <div id="pageStudentEvents" class="page">
            <h2>Available NSS Events</h2>
            <p>Apply to events posted by NSS administrators</p>
            
            <div id="eventsList">
                <!-- Events will be populated here -->
            </div>
            
            <h3>Your Applications</h3>
            <div id="studentApplications">
                <!-- Student applications will be populated here -->
            </div>
            
            <button class="back-button" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Logout</button>
        </div>
        
        <!-- Page 5: Admin Login -->
        <div id="pageAdminLogin" class="page">
            <h2>Admin Login</h2>
            
            <div class="input-group">
                <label for="adminPassword">Admin Password</label>
                <input type="password" id="adminPassword" placeholder="Enter admin password">
            </div>
            
            <button onclick="loginAdmin()"><i class="fas fa-unlock"></i> Login</button>
            <button class="back-button" onclick="goToPage('page1')"><i class="fas fa-arrow-left"></i> Back</button>
        </div>
        
        <!-- Page 6: Admin Dashboard -->
        <div id="pageAdminDashboard" class="page">
            <h2><i class="fas fa-crown"></i> Admin Dashboard</h2>
            
            <div class="tab-container">
                <div class="tab active" onclick="switchTab('events')">Event Management</div>
                <div class="tab" onclick="switchTab('applications')">Application Approval</div>
                <div class="tab" onclick="switchTab('portfolio')">Student Portfolios</div>
            </div>
            
            <!-- Events Tab -->
            <div id="eventsTab" class="tab-content active">
                <div class="admin-panel">
                    <h3>Post New Event</h3>
                    
                    <div class="input-group">
                        <label for="eventTitle">Event Title</label>
                        <input type="text" id="eventTitle" placeholder="Enter event title">
                    </div>
                    
                    <div class="input-group">
                        <label for="eventDate">Event Date</label>
                        <input type="date" id="eventDate">
                    </div>
                    
                    <div class="input-group">
                        <label for="eventDescription">Event Description</label>
                        <textarea id="eventDescription" rows="4" placeholder="Describe the event..."></textarea>
                    </div>
                    
                    <div class="input-group">
                        <label for="eventLocation">Event Location</label>
                        <input type="text" id="eventLocation" placeholder="Enter event location">
                    </div>
                    
                    <div class="input-group">
                        <label for="eventCapacity">Participant Capacity</label>
                        <input type="number" id="eventCapacity" placeholder="Enter maximum participants">
                    </div>
                    
                    <button onclick="postEvent()"><i class="fas fa-paper-plane"></i> Post Event</button>
                </div>
                
                <h3>Posted Events</h3>
                <div id="adminEventsList">
                    <!-- Admin events will be listed here -->
                </div>
            </div>
            
            <!-- Applications Tab -->
            <div id="applicationsTab" class="tab-content">
                <div class="input-group">
                    <label for="adminAppPassword">Admin Password</label>
                    <input type="password" id="adminAppPassword" placeholder="Enter admin password">
                </div>
                
                <button onclick="accessApplicationPage()"><i class="fas fa-unlock"></i> Access Applications</button>
                
                <div id="applicationsPanel" style="display: none;">
                    <h3>Event Applications</h3>
                    <div id="applicationsList">
                        <!-- Applications will be listed here -->
                    </div>
                </div>
            </div>
            
            <!-- Portfolio Tab -->
            <div id="portfolioTab" class="tab-content">
                <div class="admin-panel">
                    <h3>Create Student Portfolio</h3>
                    
                    <div class="input-group">
                        <label for="portfolioRollNumber">Student Roll Number</label>
                        <input type="text" id="portfolioRollNumber" placeholder="Enter student's roll number">
                    </div>
                    
                    <label for="portfolioPhoto" class="file-input-label">
                        <i class="fas fa-camera"></i> Upload Student Photo
                    </label>
                    <input type="file" id="portfolioPhoto" accept="image/*" onchange="previewPhoto(this, 'portfolioPhotoPreview')">
                    <img id="portfolioPhotoPreview" class="photo-preview" src="" alt="Student Photo">
                    
                    <div class="input-group">
                        <label for="portfolioFullName">Full Name</label>
                        <input type="text" id="portfolioFullName" placeholder="Enter student's full name">
                    </div>
                    
                    <div class="input-group">
                        <label for="portfolioBranch">Branch</label>
                        <select id="portfolioBranch">
                            <option value="">Select branch</option>
                            <option value="CSE">Computer Science & Engineering</option>
                            <option value="ECE">Electronics & Communication Engineering</option>
                            <option value="EEE">Electrical & Electronics Engineering</option>
                            <option value="ME">Mechanical Engineering</option>
                            <option value="CE">Civil Engineering</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    
                    <h4>NSS Events</h4>
                    <div id="portfolioEventsContainer">
                        <!-- Event sections will be added here -->
                    </div>
                    
                    <div class="event-controls">
                        <button onclick="addPortfolioEventSection()"><i class="fas fa-plus"></i> Add Event</button>
                        <button onclick="removePortfolioEventSection()" style="background: linear-gradient(to right, #8B0000, #000080);">
                            <i class="fas fa-minus"></i> Remove Event
                        </button>
                    </div>
                    
                    <button onclick="createPortfolio()"><i class="fas fa-paper-plane"></i> Create Portfolio</button>
                </div>
                
                <h3>Student Portfolios</h3>
                <div id="portfoliosList">
                    <!-- Portfolios will be listed here -->
                </div>
            </div>
            
            <button class="back-button" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Logout</button>
        </div>
    </div>
    
    <div class="footer">
        Welcome to CMRIT NSS Unit - Serving the Community
    </div>

    <!-- Portfolio View Modal -->
    <div id="portfolioModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal()">&times;</span>
            <div id="modalContent">
                <!-- Portfolio content will be loaded here -->
            </div>
        </div>
    </div>

    <script>
        // Store data (simulating database)
        let students = JSON.parse(localStorage.getItem('nssStudents')) || [];
        let events = JSON.parse(localStorage.getItem('nssEvents')) || [];
        let applications = JSON.parse(localStorage.getItem('nssApplications')) || [];
        let portfolios = JSON.parse(localStorage.getItem('nssPortfolios')) || [];
        let currentStudent = null;
        let portfolioEventCount = 1;
        
        // Initialize portfolio event sections
        function initPortfolioEventSections() {
            const eventsContainer = document.getElementById('portfolioEventsContainer');
            eventsContainer.innerHTML = '';
            portfolioEventCount = 1;
            addPortfolioEventSection();
        }
        
        // Add a new event section to portfolio form
        function addPortfolioEventSection() {
            const eventsContainer = document.getElementById('portfolioEventsContainer');
            
            const eventSection = document.createElement('div');
            eventSection.className = 'event-section';
            eventSection.innerHTML = `
                <h4>Event #${portfolioEventCount}</h4>
                <div class="input-group">
                    <label for="portfolioEventTitle${portfolioEventCount}">Event Title</label>
                    <input type="text" id="portfolioEventTitle${portfolioEventCount}" placeholder="Enter event title">
                </div>
                
                <div class="input-group">
                    <label for="portfolioEventDescription${portfolioEventCount}">Event Description</label>
                    <textarea id="portfolioEventDescription${portfolioEventCount}" rows="3" placeholder="Describe the event..."></textarea>
                </div>
                
                <label for="portfolioEventPhotos${portfolioEventCount}" class="file-input-label">
                    <i class="fas fa-images"></i> Upload Event Photos (Multiple)
                </label>
                <input type="file" id="portfolioEventPhotos${portfolioEventCount}" accept="image/*" multiple>
                
                <div id="portfolioEventPreview${portfolioEventCount}" class="events-gallery"></div>
            `;
            
            eventsContainer.appendChild(eventSection);
            
            // Add event listener for photo preview
            const fileInput = document.getElementById(`portfolioEventPhotos${portfolioEventCount}`);
            fileInput.addEventListener('change', function() {
                previewPortfolioEventPhotos(this, `portfolioEventPreview${portfolioEventCount}`);
            });
            
            portfolioEventCount++;
        }
        
        // Remove the last event section from portfolio form
        function removePortfolioEventSection() {
            const eventsContainer = document.getElementById('portfolioEventsContainer');
            if (eventsContainer.children.length > 1) {
                eventsContainer.removeChild(eventsContainer.lastChild);
                portfolioEventCount--;
            }
        }
        
        // Preview portfolio event photos
        function previewPortfolioEventPhotos(input, previewId) {
            const gallery = document.getElementById(previewId);
            gallery.innerHTML = '';
            
            const files = input.files;
            
            if (files) {
                for (let i = 0; i < files.length; i++) {
                    const reader = new FileReader();
                    
                    reader.onload = function(e) {
                        const img = document.createElement('img');
                        img.src = e.target.result;
                        img.className = 'event-photo';
                        gallery.appendChild(img);
                    }
                    
                    reader.readAsDataURL(files[i]);
                }
            }
        }
        
        // Check password strength
        function checkPasswordStrength(password) {
            const strengthBar = document.getElementById('passwordStrength');
            let strength = 0;
            
            // If password is not empty
            if (password.length > 0) {
                // If password contains both letters and numbers, increase strength
                if (password.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)) strength += 1;
                
                // If password has numbers and characters
                if (password.match(/([a-zA-Z])/) && password.match(/([0-9])/)) strength += 1;
                
                // If password has special characters
                if (password.match(/([!,@,#,$,%,^,&,*,?,_,~])/)) strength += 1;
                
                // If password is greater than 7
                if (password.length > 7) strength += 1;
            }
            
            // Update strength bar
            switch(strength) {
                case 0:
                    strengthBar.className = 'password-strength';
                    break;
                case 1:
                    strengthBar.className = 'password-strength weak';
                    break;
                case 2:
                    strengthBar.className = 'password-strength medium';
                    break;
                case 3:
                case 4:
                    strengthBar.className = 'password-strength strong';
                    break;
            }
        }
        
        // Register new student
        function registerStudent() {
            const rollNumber = document.getElementById('regRollNumber').value;
            const fullName = document.getElementById('regFullName').value;
            const branch = document.getElementById('regBranch').value;
            const password = document.getElementById('regPassword').value;
            const confirmPassword = document.getElementById('regConfirmPassword').value;
            
            // Validate inputs
            if (!rollNumber || !fullName || !branch || !password || !confirmPassword) {
                alert("Please fill in all fields.");
                return;
            }
            
            if (rollNumber.length !== 10) {
                alert("Roll number must be exactly 10 digits.");
                return;
            }
            
            if (password.length < 8) {
                alert("Password must be at least 8 characters long.");
                return;
            }
            
            if (!/(?=.*[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?])/.test(password)) {
                alert("Password must contain at least one special character.");
                return;
            }
            
            if (password !== confirmPassword) {
                alert("Passwords do not match.");
                return;
            }
            
            // Check if student already exists
            if (students.find(s => s.rollNumber === rollNumber)) {
                alert("Student with this roll number already exists. Please login instead.");
                return;
            }
            
            // Save student
            students.push({
                rollNumber,
                fullName,
                branch,
                password
            });
            
            localStorage.setItem('nssStudents', JSON.stringify(students));
            
            alert("Registration successful! Please login with your credentials.");
            goToPage('pageStudentLogin');
        }
        
        // Login student
        function loginStudent() {
            const rollNumber = document.getElementById('studentRollNumber').value;
            const password = document.getElementById('studentPassword').value;
            
            // Validate inputs
            if (!rollNumber || !password) {
                alert("Please enter both roll number and password.");
                return;
            }
            
            // Check credentials
            const student = students.find(s => s.rollNumber === rollNumber && s.password === password);
            
            if (student) {
                currentStudent = student;
                loadStudentEvents();
                goToPage('pageStudentEvents');
            } else {
                alert("Invalid roll number or password. Please try again.");
            }
        }
        
        // Login admin
        function loginAdmin() {
            const password = document.getElementById('adminPassword').value;
            const correctPassword = "CMRIT@NSS2025";
            
            if (password === correctPassword) {
                loadAdminEvents();
                loadPortfolios();
                goToPage('pageAdminDashboard');
            } else {
                alert("Incorrect admin password. Please try again.");
            }
        }
        
        // Access application page
        function accessApplicationPage() {
            const password = document.getElementById('adminAppPassword').value;
            const correctPassword = "NSS2025";
            
            if (password === correctPassword) {
                document.getElementById('applicationsPanel').style.display = 'block';
                loadApplications();
            } else {
                alert("Incorrect admin password. Please try again.");
            }
        }
        
        // Switch between admin tabs
        function switchTab(tabName) {
            // Deactivate all tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Deactivate all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Activate selected tab
            const tabs = document.querySelectorAll('.tab');
            tabs[tabName === 'events' ? 0 : tabName === 'applications' ? 1 : 2].classList.add('active');
            
            // Activate selected tab content
            document.getElementById(`${tabName}Tab`).classList.add('active');
            
            // Load data if needed
            if (tabName === 'applications') {
                document.getElementById('applicationsPanel').style.display = 'none';
            } else if (tabName === 'portfolio') {
                loadPortfolios();
            }
        }
        
        // Load events for students
        function loadStudentEvents() {
            const eventsList = document.getElementById('eventsList');
            eventsList.innerHTML = '';
            
            if (events.length === 0) {
                eventsList.innerHTML = '<p>No events available at the moment. Please check back later.</p>';
                return;
            }
            
            events.forEach(event => {
                const eventCard = document.createElement('div');
                eventCard.className = 'event-card';
                
                // Check if student has already applied
                const hasApplied = applications.find(a => 
                    a.eventId === event.id && a.rollNumber === currentStudent.rollNumber
                );
                
                eventCard.innerHTML = `
                    <h4>${event.title}</h4>
                    <p><strong>Date:</strong> ${new Date(event.date).toLocaleDateString()}</p>
                    <p><strong>Location:</strong> ${event.location}</p>
                    <p><strong>Capacity:</strong> ${event.capacity} participants</p>
                    <p>${event.description}</p>
                    <p><strong>Applications:</strong> ${event.applications || 0}/${event.capacity}</p>
                    ${hasApplied ? 
                        `<span class="status-badge status-${hasApplied.status}">${hasApplied.status.toUpperCase()}</span>` :
                        `<button onclick="applyForEvent(${event.id})" ${(event.applications || 0) >= event.capacity ? 'disabled style="opacity: 0.5;"' : ''}>
                            <i class="fas fa-check"></i> Apply
                        </button>`
                    }
                `;
                
                eventsList.appendChild(eventCard);
            });
            
            // Load student applications
            loadStudentApplications();
        }
        
        // Load student applications
        function loadStudentApplications() {
            const applicationsContainer = document.getElementById('studentApplications');
            applicationsContainer.innerHTML = '';
            
            const studentApps = applications.filter(a => a.rollNumber === currentStudent.rollNumber);
            
            if (studentApps.length === 0) {
                applicationsContainer.innerHTML = '<p>You have not applied to any events yet.</p>';
                return;
            }
            
            studentApps.forEach(app => {
                const event = events.find(e => e.id === app.eventId);
                
                if (event) {
                    const appElement = document.createElement('div');
                    appElement.className = 'application-item';
                    
                    appElement.innerHTML = `
                        <div>
                            <h4>${event.title}</h4>
                            <p>Applied on: ${new Date(app.applicationDate).toLocaleDateString()}</p>
                        </div>
                        <span class="status-badge status-${app.status}">${app.status.toUpperCase()}</span>
                    `;
                    
                    applicationsContainer.appendChild(appElement);
                }
            });
        }
        
        // Apply for an event
        function applyForEvent(eventId) {
            const event = events.find(e => e.id === eventId);
            
            if (!event) {
                alert("Event not found.");
                return;
            }
            
            // Check if event is full
            if ((event.applications || 0) >= event.capacity) {
                alert("This event is already full. You cannot apply.");
                return;
            }
            
            // Check if already applied
            const existingApplication = applications.find(a => 
                a.eventId === eventId && a.rollNumber === currentStudent.rollNumber
            );
            
            if (existingApplication) {
                alert("You have already applied to this event.");
                return;
            }
            
            // Create application
            applications.push({
                id: Date.now(),
                eventId,
                rollNumber: currentStudent.rollNumber,
                studentName: currentStudent.fullName,
                branch: currentStudent.branch,
                applicationDate: new Date().toISOString(),
                status: 'pending' // pending, approved, rejected
            });
            
            // Update event application count
            event.applications = (event.applications || 0) + 1;
            
            // Save data
            localStorage.setItem('nssApplications', JSON.stringify(applications));
            localStorage.setItem('nssEvents', JSON.stringify(events));
            
            alert("Application submitted successfully!");
            loadStudentEvents();
        }
        
        // Post new event
        function postEvent() {
            const title = document.getElementById('eventTitle').value;
            const date = document.getElementById('eventDate').value;
            const description = document.getElementById('eventDescription').value;
            const location = document.getElementById('eventLocation').value;
            const capacity = document.getElementById('eventCapacity').value;
            
            if (!title || !date || !description || !location || !capacity) {
                alert("Please fill in all event details.");
                return;
            }
            
            const newEvent = {
                id: Date.now(),
                title,
                date,
                description,
                location,
                capacity: parseInt(capacity),
                applications: 0,
                postedDate: new Date().toISOString()
            };
            
            events.push(newEvent);
            localStorage.setItem('nssEvents', JSON.stringify(events));
            
            alert("Event posted successfully!");
            
            // Clear form
            document.getElementById('eventTitle').value = '';
            document.getElementById('eventDate').value = '';
            document.getElementById('eventDescription').value = '';
            document.getElementById('eventLocation').value = '';
            document.getElementById('eventCapacity').value = '';
            
            loadAdminEvents();
        }
        
        // Load events for admin
        function loadAdminEvents() {
            const eventsList = document.getElementById('adminEventsList');
            eventsList.innerHTML = '';
            
            if (events.length === 0) {
                eventsList.innerHTML = '<p>No events posted yet.</p>';
                return;
            }
            
            events.forEach(event => {
                const eventElement = document.createElement('div');
                eventElement.className = 'admin-event';
                
                eventElement.innerHTML = `
                    <h4>${event.title}</h4>
                    <p><strong>Date:</strong> ${new Date(event.date).toLocaleDateString()}</p>
                    <p><strong>Location:</strong> ${event.location}</p>
                    <p><strong>Capacity:</strong> ${event.applications || 0}/${event.capacity}</p>
                    <p>${event.description}</p>
                    <button onclick="viewApplications(${event.id})">
                        <i class="fas fa-users"></i> View Applications
                    </button>
                `;
                
                eventsList.appendChild(eventElement);
            });
        }
        
        // View applications for an event
        function viewApplications(eventId) {
            // Store the event ID for the applications page
            sessionStorage.setItem('currentEventId', eventId);
            switchTab('applications');
        }
        
        // Load applications for admin approval
        function loadApplications() {
            const applicationsList = document.getElementById('applicationsList');
            applicationsList.innerHTML = '';
            
            const eventId = parseInt(sessionStorage.getItem('currentEventId'));
            const event = events.find(e => e.id === eventId);
            
            if (!event) {
                applicationsList.innerHTML = '<p>Event not found.</p>';
                return;
            }
            
            // Show event info
            const eventInfo = document.createElement('div');
            eventInfo.className = 'admin-event';
            eventInfo.innerHTML = `
                <h4>${event.title}</h4>
                <p><strong>Date:</strong> ${new Date(event.date).toLocaleDateString()}</p>
                <p><strong>Location:</strong> ${event.location}</p>
                <p><strong>Capacity:</strong> ${event.applications || 0}/${event.capacity}</p>
            `;
            applicationsList.appendChild(eventInfo);
            
            // Get applications for this event
            const eventApplications = applications.filter(a => a.eventId === eventId);
            
            if (eventApplications.length === 0) {
                applicationsList.innerHTML += '<p>No applications for this event yet.</p>';
                return;
            }
            
            eventApplications.forEach(app => {
                const appElement = document.createElement('div');
                appElement.className = 'application-item';
                
                appElement.innerHTML = `
                    <div>
                        <h4>${app.studentName}</h4>
                        <p>Roll No: ${app.rollNumber} | Branch: ${app.branch}</p>
                        <p>Applied on: ${new Date(app.applicationDate).toLocaleDateString()}</p>
                    </div>
                    <div class="application-actions">
                        ${app.status === 'pending' ? `
                            <button class="btn-approve" onclick="updateApplication(${app.id}, 'approved')">
                                <i class="fas fa-check"></i> Approve
                            </button>
                            <button class="btn-reject" onclick="updateApplication(${app.id}, 'rejected')">
                                <i class="fas fa-times"></i> Reject
                            </button>
                        ` : `
                            <span class="status-badge status-${app.status}">${app.status.toUpperCase()}</span>
                        `}
                    </div>
                `;
                
                applicationsList.appendChild(appElement);
            });
        }
        
        // Update application status
        function updateApplication(applicationId, status) {
            const application = applications.find(a => a.id === applicationId);
            
            if (!application) {
                alert("Application not found.");
                return;
            }
            
            // Update status
            application.status = status;
            localStorage.setItem('nssApplications', JSON.stringify(applications));
            
            alert(`Application ${status} successfully!`);
            loadApplications();
        }
        
        // Create student portfolio
        function createPortfolio() {
            const rollNumber = document.getElementById('portfolioRollNumber').value;
            const fullName = document.getElementById('portfolioFullName').value;
            const branch = document.getElementById('portfolioBranch').value;
            
            // Basic validation
            if (!rollNumber || !fullName || !branch) {
                alert("Please fill in all required fields.");
                return;
            }
            
            // Get student photo
            const studentPhoto = document.getElementById('portfolioPhotoPreview').src;
            
            // Get events data
            const portfolioEvents = [];
            const eventSections = document.querySelectorAll('#portfolioEventsContainer .event-section');
            
            for (let i = 0; i < eventSections.length; i++) {
                const eventTitle = document.getElementById(`portfolioEventTitle${i+1}`).value;
                const eventDescription = document.getElementById(`portfolioEventDescription${i+1}`).value;
                
                if (eventTitle) {
                    // Get event photos
                    const eventPhotos = [];
                    const eventFiles = document.getElementById(`portfolioEventPhotos${i+1}`).files;
                    
                    if (eventFiles.length > 0) {
                        for (let j = 0; j < eventFiles.length; j++) {
                            const reader = new FileReader();
                            
                            reader.onload = function(e) {
                                eventPhotos.push(e.target.result);
                            }
                            
                            reader.readAsDataURL(eventFiles[j]);
                        }
                    }
                    
                    portfolioEvents.push({
                        title: eventTitle,
                        description: eventDescription,
                        photos: eventPhotos
                    });
                }
            }
            
            // Check if we have at least one event
            if (portfolioEvents.length === 0) {
                alert("Please add at least one event.");
                return;
            }
            
            // Save portfolio data
            savePortfolio(rollNumber, fullName, branch, studentPhoto, portfolioEvents);
        }
        
        // Save portfolio data
        function savePortfolio(rollNumber, fullName, branch, studentPhoto, portfolioEvents) {
            // Check if portfolio already exists
            const existingPortfolioIndex = portfolios.findIndex(p => p.rollNumber === rollNumber);
            
            // Generate or keep the same QR code URL
            let qrCodeUrl = `${window.location.origin}${window.location.pathname}?portfolio=${rollNumber}`;
            
            // If portfolio exists, keep the same QR code
            if (existingPortfolioIndex !== -1) {
                qrCodeUrl = portfolios[existingPortfolioIndex].qrCodeUrl;
            }
            
            const portfolioData = {
                id: existingPortfolioIndex !== -1 ? portfolios[existingPortfolioIndex].id : Date.now(),
                rollNumber,
                fullName,
                branch,
                studentPhoto,
                events: portfolioEvents,
                qrCodeUrl,
                timestamp: new Date().toISOString()
            };
            
            if (existingPortfolioIndex !== -1) {
                // Update existing portfolio
                portfolios[existingPortfolioIndex] = portfolioData;
                console.log("Updating portfolio for student:", rollNumber);
            } else {
                // Add new portfolio
                portfolios.push(portfolioData);
                console.log("Creating new portfolio for student:", rollNumber);
            }
            
            // Save to localStorage
            localStorage.setItem('nssPortfolios', JSON.stringify(portfolios));
            
            alert("Portfolio created successfully!");
            
            // Clear form
            document.getElementById('portfolioRollNumber').value = '';
            document.getElementById('portfolioFullName').value = '';
            document.getElementById('portfolioBranch').value = '';
            document.getElementById('portfolioPhotoPreview').src = '';
            initPortfolioEventSections();
            
            // Reload portfolios list
            loadPortfolios();
        }
        
        // Load portfolios for admin
        function loadPortfolios() {
            const portfoliosList = document.getElementById('portfoliosList');
            portfoliosList.innerHTML = '';
            
            if (portfolios.length === 0) {
                portfoliosList.innerHTML = '<p>No portfolios created yet.</p>';
                return;
            }
            
            portfolios.forEach(portfolio => {
                const portfolioElement = document.createElement('div');
                portfolioElement.className = 'admin-event';
                
                portfolioElement.innerHTML = `
                    <h4>${portfolio.fullName} (${portfolio.rollNumber})</h4>
                    <p><strong>Branch:</strong> ${portfolio.branch}</p>
                    <p><strong>Events:</strong> ${portfolio.events.length}</p>
                    <p><strong>Created:</strong> ${new Date(portfolio.timestamp).toLocaleDateString()}</p>
                    <button onclick="viewPortfolio('${portfolio.rollNumber}')">
                        <i class="fas fa-eye"></i> View Portfolio
                    </button>
                    <button onclick="showQRCode('${portfolio.rollNumber}')" style="background: linear-gradient(to right, #8B0000, #000080);">
                        <i class="fas fa-qrcode"></i> View QR Code
                    </button>
                    <button onclick="editPortfolio('${portfolio.rollNumber}')" style="background: linear-gradient(to right, #000080, #8B0000);">
                        <i class="fas fa-edit"></i> Edit
                    </button>
                    <button onclick="deletePortfolio('${portfolio.rollNumber}')" style="background: linear-gradient(to right, #8B0000, #000080);">
                        <i class="fas fa-trash"></i> Delete
                    </button>
                `;
                
                portfoliosList.appendChild(portfolioElement);
            });
        }
        
        // View portfolio
        function viewPortfolio(rollNumber) {
            const portfolio = portfolios.find(p => p.rollNumber === rollNumber);
            
            if (portfolio) {
                const modalContent = document.getElementById('modalContent');
                modalContent.innerHTML = `
                    <h2>${portfolio.fullName}'s Portfolio</h2>
                    <div class="portfolio-container">
                        <img src="${portfolio.studentPhoto}" class="portfolio-photo" alt="${portfolio.fullName}">
                        
                        <div class="portfolio-details">
                            <p><strong>Name:</strong> ${portfolio.fullName}</p>
                            <p><strong>Roll Number:</strong> ${portfolio.rollNumber}</p>
                            <p><strong>Branch:</strong> ${portfolio.branch}</p>
                        </div>
                        
                        <h3>NSS Events</h3>
                        ${portfolio.events.map(event => `
                            <div class="event-item">
                                <h4>${event.title}</h4>
                                <p>${event.description}</p>
                                ${event.photos && event.photos.length > 0 ? `
                                    <div class="events-gallery">
                                        ${event.photos.map(photo => `
                                            <img src="${photo}" class="event-photo" alt="${event.title}">
                                        `).join('')}
                                    </div>
                                ` : ''}
                            </div>
                        `).join('')}
                    </div>
                `;
                
                document.getElementById('portfolioModal').style.display = 'flex';
            }
        }
        
        // Show QR code for portfolio
        function showQRCode(rollNumber) {
            const portfolio = portfolios.find(p => p.rollNumber === rollNumber);
            
            if (portfolio) {
                const modalContent = document.getElementById('modalContent');
                modalContent.innerHTML = `
                    <h2>QR Code for ${portfolio.fullName}</h2>
                    <div class="portfolio-container">
                        <div id="portfolioQRCode"></div>
                        <div class="qr-info">
                            <p><i class="fas fa-info-circle"></i> This QR code is permanently linked to this portfolio.</p>
                            <p><i class="fas fa-sync-alt"></i> It will remain the same even if the portfolio is updated.</p>
                        </div>
                        <button class="download-btn" onclick="downloadQRCode('${portfolio.rollNumber}')">
                            <i class="fas fa-download"></i> Download QR Code
                        </button>
                    </div>
                `;
                
                // Generate QR Code
                const qrContainer = document.getElementById('portfolioQRCode');
                qrContainer.innerHTML = '';
                
                new QRCode(qrContainer, {
                    text: portfolio.qrCodeUrl,
                    width: 200,
                    height: 200,
                    colorDark: "#000000",
                    colorLight: "#ffffff",
                    correctLevel: QRCode.CorrectLevel.H
                });
                
                document.getElementById('portfolioModal').style.display = 'flex';
            }
        }
        
        // Download QR Code
        function downloadQRCode(rollNumber) {
            const portfolio = portfolios.find(p => p.rollNumber === rollNumber);
            
            if (portfolio) {
                const qrCanvas = document.querySelector('#portfolioQRCode canvas');
                if (qrCanvas) {
                    const link = document.createElement('a');
                    link.download = `CMRIT-NSS-${portfolio.rollNumber}.png`;
                    link.href = qrCanvas.toDataURL('image/png');
                    link.click();
                }
            }
        }
        
        // Edit portfolio
        function editPortfolio(rollNumber) {
            const portfolio = portfolios.find(p => p.rollNumber === rollNumber);
            
            if (portfolio) {
                // Fill form with portfolio data
                document.getElementById('portfolioRollNumber').value = portfolio.rollNumber;
                document.getElementById('portfolioFullName').value = portfolio.fullName;
                document.getElementById('portfolioBranch').value = portfolio.branch;
                document.getElementById('portfolioPhotoPreview').src = portfolio.studentPhoto;
                
                // Clear existing events
                initPortfolioEventSections();
                
                // Add events
                portfolio.events.forEach((event, index) => {
                    if (index > 0) addPortfolioEventSection();
                    
                    document.getElementById(`portfolioEventTitle${index+1}`).value = event.title;
                    document.getElementById(`portfolioEventDescription${index+1}`).value = event.description;
                    
                    // Note: Can't pre-fill file inputs for security reasons
                });
                
                alert("Portfolio data loaded. Make changes and click 'Create Portfolio' to update.");
            }
        }
        
        // Delete portfolio
        function deletePortfolio(rollNumber) {
            if (confirm("Are you sure you want to delete this portfolio? This action cannot be undone.")) {
                portfolios = portfolios.filter(p => p.rollNumber !== rollNumber);
                localStorage.setItem('nssPortfolios', JSON.stringify(portfolios));
                loadPortfolios();
                alert("Portfolio deleted successfully!");
            }
        }
        
        // Close modal
        function closeModal() {
            document.getElementById('portfolioModal').style.display = 'none';
        }
        
        // Photo preview function
        function previewPhoto(input, previewId) {
            const preview = document.getElementById(previewId);
            const file = input.files[0];
            
            if (file) {
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    preview.src = e.target.result;
                }
                
                reader.readAsDataURL(file);
            }
        }
        
        // Logout
        function logout() {
            currentStudent = null;
            sessionStorage.removeItem('currentEventId');
            goToPage('page1');
        }
        
        // Navigate to page
        function goToPage(pageId) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // Show selected page
            document.getElementById(pageId).classList.add('active');
            
            // Initialize portfolio events if needed
            if (pageId === 'pageAdminDashboard') {
                initPortfolioEventSections();
            }
            
            // Scroll to top
            window.scrollTo(0, 0);
        }
        
        // Check if URL has a portfolio parameter
        function checkPortfolioParam() {
            const urlParams = new URLSearchParams(window.location.search);
            const portfolioParam = urlParams.get('portfolio');
            
            if (portfolioParam) {
                const portfolio = portfolios.find(p => p.rollNumber === portfolioParam);
                
                if (portfolio) {
                    const modalContent = document.getElementById('modalContent');
                    modalContent.innerHTML = `
                        <h2>${portfolio.fullName}'s Portfolio</h2>
                        <div class="portfolio-container">
                            <img src="${portfolio.studentPhoto}" class="portfolio-photo" alt="${portfolio.fullName}">
                            
                            <div class="portfolio-details">
                                <p><strong>Name:</strong> ${portfolio.fullName}</p>
                                <p><strong>Roll Number:</strong> ${portfolio.rollNumber}</p>
                                <p><strong>Branch:</strong> ${portfolio.branch}</p>
                            </div>
                            
                            <h3>NSS Events</h3>
                            ${portfolio.events.map(event => `
                                <div class="event-item">
                                    <h4>${event.title}</h4>
                                    <p>${event.description}</p>
                                    ${event.photos && event.photos.length > 0 ? `
                                        <div class="events-gallery">
                                            ${event.photos.map(photo => `
                                                <img src="${photo}" class="event-photo" alt="${event.title}">
                                            `).join('')}
                                        </div>
                                    ` : ''}
                                </div>
                            `).join('')}
                        </div>
                    `;
                    
                    document.getElementById('portfolioModal').style.display = 'flex';
                    return true;
                }
            }
            
            return false;
        }
        
        // Initialize the application
        function init() {
            // Add event listener for password strength checking
            const regPassword = document.getElementById('regPassword');
            if (regPassword) {
                regPassword.addEventListener('input', function() {
                    checkPasswordStrength(this.value);
                });
            }
            
            // Initialize portfolio event sections
            initPortfolioEventSections();
            
            // Check if we're viewing a portfolio from URL
            const isViewingPortfolio = checkPortfolioParam();
            
            if (!isViewingPortfolio) {
                // Show the first page
                goToPage('page1');
            }
            
            // Animated footer text
            const footer = document.querySelector('.footer');
            const text = "Welcome to CMRIT NSS Unit - Serving the Community";
            footer.innerHTML = '';
            let index = 0;
            
            function typeWriter() {
                if (index < text.length) {
                    footer.innerHTML += text.charAt(index);
                    index++;
                    setTimeout(typeWriter, 100);
                }
            }
            
            typeWriter();
        }
        
        // Initialize when page loads
        window.onload = init;
    </script>
</body>
</html>